generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}

model User {
  id           Int          @id @default(autoincrement())
  name         String       @unique @db.VarChar(255)
  email        String       @unique @db.VarChar(255)
  password     String       @db.VarChar(255)
  avatar       String?      @db.VarChar(255)
  vocabularies Vocabulary[]
  memories     Memory[]
}

model Vocabulary {
  id          Int      @id @default(autoincrement())
  word        String   @unique @map("origin") @db.VarChar(255)
  translation String
  createdAt   DateTime @default(now()) @db.Timestamp(6)
  users       User[]
  memories    Memory[]
}

enum MemoryStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
}

enum MemoryLevel {
  LEVEL_1
  LEVEL_2
  LEVEL_3
  LEVEL_4
  LEVEL_5
  MASTERED
}

model Memory {
  id             Int          @id @default(autoincrement())
  userId         Int
  vocabularyId   Int
  level          MemoryLevel  @default(LEVEL_1)
  reviewCount    Int          @default(0)
  lastReviewedAt DateTime?
  nextReviewDate DateTime?
  status         MemoryStatus @default(NOT_STARTED)
  createdAt      DateTime     @default(now()) @db.Timestamp(6)
  updatedAt      DateTime     @updatedAt
  user           User         @relation(fields: [userId], references: [id])
  vocabulary     Vocabulary   @relation(fields: [vocabularyId], references: [id])

  @@unique([userId, vocabularyId])
}
